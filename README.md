# Interm-attach-cells-
Accompanying code for Panigrahi et al. 'Intermittent attachments form three-dimensional cell aggregates with emergent fluid properties'

This code is built on the LAMMPS platform which is freely availble and can be downloaded from its official website. This code has been tested only with the version of LAMMPS that was released on 29th September 2021, and has not been tested with any other version of LAMMPS. Below I provide the instructions to run this code, which have been tested on a Ubuntu 22.04.5 LTS operating system. 

This repository contains three folders:

(1) Standalone: This contains the source codes and associated initial conditions that are required to run the program as a lammps executable. In order to do this, you have to download the LAMMPS source code from the LAMMPS website, and copy all the .h and .cpp files present in this folder to the src/ directory of LAMMPS. Within this directory you can compile the code using the command 'make mpi', and the compilation should work provided that you have a standard C++ 11 compiler installed in your environment. 

After that you can copy the other .init and .interm files to a directory which will be used to run the program. I prefer to create a folder within the examples/ directory and within this folder run the program using this command: 'mpirun -np 16 ../../src/lmp_mpi -in in3d.interm -log none'. This is a standard way of running LAMMPS as an executable, and further documentation of this command can be found in the official website of LAMMPS. After running this, you will get a .dump file in this directory, and you can use the post_process.py script to convert it to a .xyz file which you can analyze using standard visualization software such as OVITO.

(2) Chemotaxis: In contrast to the previously mentioned technique, here we are using LAMMPS as a shared library and running it using our own C++ driver code. Similar to (1), the first step is to copy the .cpp and .h files (except the main_chem.cpp) in this directory to the src/ directory of LAMMPS. Note that while the file names are the same, there is a subtle difference in one of the .cpp files, as compared to (1). Within the src/ directory the code can be compiled using the command: 'make mode=shared mpi'. After that you need to make sure that this folder is added to your library path so that the compiler can identify it as a library. There can be several ways to do this, what I do is the following: Go to the .basrc file in my home directory and include this line: 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/local/dppan/LAMMPS_code_dir/lammps-29Sep2021/src/'. Save the .bashrc file and you may need to restart your computer for this command to take effect! After this you can copy the remaining files to another folder which you will use to run the program, I like to create my own folder in the examples/COUPLE/ directory of LAMMPS. The code can now be compiled using this command: 'mpic++ -c -O -I../../../src main_chem.cpp', followed by 'mpic++ -o main_dicty main_dicty.o -L../../../src -llammps_mpi'. Please make sure to adjust these commands based on the relative locations of the main_chem.cpp file and the LAMMPS src/ directory. After this you can run the code using the command: 'mpirun -np 8 main_dicty 8 in3d.chem input.dat' where the number 8 refers to the number of parallel processors, you can use as many as you like, but for the initial conditions provided in this repository 8 parallel threads should suffice. 

(3) Post_process: This folder contains several scripts which can be used to analyze different aspects of the data generated by the program:
 (i) process_contact_area.py: It measures the contact area of a cell aggregate with the surface.
 (ii) process_shape_fluctuations.py: It measures the steady state shape fluctuations of a surface associated cell aggregate.
 (iii) post_process_from_lammps_dump.py: It simply creates a .xyz file from a LAMMPS .dump file. It is the same as the post_process.py script in (1). 
 (iv) measure_st.py: It can be used to measure the surface tension of a cell aggregate using a parallel plate compression test. Refer to the paper for the physical details and formula used. 
 (v) compute_msd.py: It can be used to compute the mean squared displacement of a cell aggregate over time. It assumes a periodic boundary along all directions.
 (vi) compute_emg_diff.py: It computes the effective diffusion coefficient using the mean squared displacement vs. time data generated from (v). 
 (vii) analyze_migration.py: It can be used to analyze several aspects of the data generated from the Chemotaxis code. These include the average migration speed, bias, and receptor occupancy of the cell aggregate.
